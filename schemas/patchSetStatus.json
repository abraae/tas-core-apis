{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "app": {
            "type": "string"
        },
        "elapsedTime": {
            "description": "elapsed time of the operation in milliseconds",
            "type": "integer"
        },
        "patchSetApplyStart": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "patchSetApplyStart"
                    ]
                }
            }
        },
        "tenantDownStart": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "tenantDownStart"
                    ]
                }
            }
        },
        "appDownRequest": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "app"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appDownRequest"
                    ]
                },
                "app": {
                    "$ref": "#/definitions/app"
                }
            }
        },
        "appDownComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "app"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appDownComplete"
                    ]
                },
                "app": {
                    "$ref": "#/definitions/app"
                }
            }
        },
        "tenantDownComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "elapsedTime"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "tenantDownComplete"
                    ]
                },
                "elapsedTime": {
                    "$ref": "#/definitions/elapsedTime"
                }
            }
        },
        "appPatchesApplyStart": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appPatchesApplyStart"
                    ]
                }
            }
        },
        "appInstallComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "app"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appInstallComplete"
                    ]
                },
                "app": {
                    "$ref": "#/definitions/app"
                }
            }
        },
        "appEditComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "app"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appEditComplete"
                    ]
                },
                "app": {
                    "$ref": "#/definitions/app"
                }
            }
        },
        "appUnInstallComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "app"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appUnInstallComplete"
                    ]
                },
                "app": {
                    "$ref": "#/definitions/app"
                }
            }
        },
        "appPatchesApplyComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "elapsedTime"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appPatchesApplyComplete"
                    ]
                },
                "elapsedTime": {
                    "$ref": "#/definitions/elapsedTime"
                }
            }
        },
        "tenantUpStart": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "tenantUpStart"
                    ]
                }
            }
        },
        "appUpComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "app"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "appUpComplete"
                    ]
                },
                "app": {
                    "$ref": "#/definitions/app"
                }
            }
        },
        "tenantUpComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "elapsedTime"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "tenantUpComplete"
                    ]
                },
                "elapsedTime": {
                    "$ref": "#/definitions/elapsedTime"
                }
            }
        },
        "patchSetApplyComplete": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "kind",
                "elapsedTime",
                "newIncarnation"
            ],
            "properties": {
                "kind": {
                    "enum": [
                        "patchSetApplyComplete"
                    ]
                },
                "elapsedTime": {
                    "$ref": "#/definitions/elapsedTime"
                },
                "newIncarnation": {
                    "type": "integer"
                }
            }
        },
        "orderedEvent": {
            "type": "object",
            "properties": {
                "seq": {
                    "type": "integer"
                },
                "event": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/patchSetApplyStart"
                        },
                        {
                            "$ref": "#/definitions/tenantDownStart"
                        },
                        {
                            "$ref": "#/definitions/appDownRequest"
                        },
                        {
                            "$ref": "#/definitions/appDownComplete"
                        },
                        {
                            "$ref": "#/definitions/tenantDownComplete"
                        },
                        {
                            "$ref": "#/definitions/appPatchesApplyStart"
                        },
                        {
                            "$ref": "#/definitions/appInstallComplete"
                        },
                        {
                            "$ref": "#/definitions/appEditComplete"
                        },
                        {
                            "$ref": "#/definitions/appUnInstallComplete"
                        },
                        {
                            "$ref": "#/definitions/appPatchesApplyComplete"
                        },
                        {
                            "$ref": "#/definitions/tenantUpStart"
                        },
                        {
                            "$ref": "#/definitions/appUpComplete"
                        },
                        {
                            "$ref": "#/definitions/tenantUpComplete"
                        },
                        {
                            "$ref": "#/definitions/patchSetApplyComplete"
                        }
                    ]
                }
            }
        }
    },
    "type": "object",
    "additionalProperties": false,
    "required": [
        "kind",
        "applyStatus"
    ],
    "properties": {
        "kind": {
            "enum": [
                "patchSetStatus"
            ]
        },
        "applyStatus": {
            "enum": [
                "notLaunched",
                "inProcess",
                "complete",
                "broken"
            ]
        },
        "latestEvent": {
            "type": "integer"
        },
       "continuePage": { "type": "string", "description": "the URI that the browser should redirect the user to once this patch set is complete, possibly at a new storefront if the patch set swapped out the current one" },
        "events": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/orderedEvent"
            }
        }
    }
}